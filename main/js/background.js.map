{"version":3,"sources":["webpack:///webpack/bootstrap 4414b49ca15f5f40a855?9804****","webpack:///./src/background.js"],"names":["shouldSendToTab","url","list","should","forEach","item","match","bgUtil","ver","removeMenuItem","chrome","contextMenus","remove","createMenuItem","itemId","documentUrlPatterns","ua","navigator","userAgent","toLocaleLowerCase","create","title","id","icon","path","onclick","tabs","query","active","currentWindow","currentTab","sendMessage","cmd","response","onClicked","addListener","a","b","menuItemId","notify","params","notifications","type","iconUrl","message","setBadgeText","text","browserAction","setStorage","storage","sync","set","backgroundInit","contentMap","dlData","runtime","onMessage","request","sender","sendResponse","JSON","stringify","tab","index","indexOf","href","content","html","$","ajax","timeout","async","data","dataType","success","dist","res","responseText","uuid","sendFetchDataToContentScript","error","desc","msg","xhr","XMLHttpRequest","open","responseType","onreadystatechange","readyState","status","blob","file","FileReader","onload","result","readAsDataURL","send","console","log","fileName","downloads","download","filename","conflictAction","saveAs","e","onChanged","detail","err","state","current","tabId","click","views","extension","getViews","length","alert","document","getCurrentTabId","callback","openUrlCurrentTab","update","openUrlNewTab","testBackground"],"mappings":"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","file":"background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/main/js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4414b49ca15f5f40a855","//-------------------- 右键菜单演示 ------------------------//\r\nfunction shouldSendToTab(url) {\r\n\t// tab.url.indexOf('danbooru') > -1 || tab.url.indexOf('yande.re') > -1  ||tab.url.indexOf('localhost') > -1 || tab.url.indexOf('wonbao') > -1 || tab.url.indexOf('file:') > -1 || tab.url.indexOf('192.168') > -1\r\n\tlet list = [\r\n\t\t/danbooru/,\r\n\t\t/yande.re/,\r\n\t\t/baidu.com/,\r\n\t\t/bilibili.com/,\r\n\t\t/www.acfun.cn\\/a\\//,\r\n\t\t/localhost/,\r\n\t\t/ichi\\-up\\.net\\//,\r\n\t\t/bing\\.ioliu\\.cn/,\r\n\t\t/gbf\\.huijiwiki\\.com\\/wiki/,\r\n\t\t/arknights\\.huijiwiki\\.com\\/wiki/,\r\n\t\t/t\\.bilibili\\.com/,\r\n\t\t/space\\.bilibili\\.com/,\r\n\t\t/www\\.hpoi\\.net\\/hobby/,\r\n\t\t/www\\.hpoi\\.net\\/album/,\r\n\t\t/www\\.1999\\.co\\.jp\\/eng\\/image/,\r\n\t\t/www\\.1999\\.co\\.jp\\/image/,\r\n\t\t/(nyahentai\\.co\\/g)|(nyahentai\\.club)|(ja\\.cathentai)|(hentai.com)/,\r\n\t\t/shimo\\.im\\/docs/,\r\n\t\t/weibo\\.com/,\r\n\t\t/www\\.hpoi\\.cn\\/album/\r\n\t]\r\n\tlet should = false;\r\n\tlist.forEach((item)=>{\r\n\t\tif(url.match(item)) {\r\n\t\t\tshould = true;\r\n\t\t}\r\n\t})\r\n\treturn should;\r\n\r\n}\r\nvar bgUtil = {\r\n\tver: '1.0.0',\r\n\t// 删除右键菜单（未使用）\r\n\tremoveMenuItem: function () {\r\n\t\tchrome.contextMenus.remove('wb-context', function() {\r\n\t\t})\r\n\t},\r\n\tcreateMenuItem: function () {\r\n\t\tvar itemId = 'wb-context-add-to-copy-list';\r\n\t\t// 只在下列网站显示右键菜单\r\n\t\tvar documentUrlPatterns = [\r\n\t\t\t'https://detail.tmall.com/*',\r\n\t\t\t'https://item.taobao.com/*',\r\n\t\t\t'https://detail.1688.com/*',\r\n\t\t\t'https://h5.m.taobao.com/*',\r\n\t\t\t'https://detail.m.tmall.com/*',\r\n\t\t\t'https://m.1688.com/*'\r\n\t\t];\r\n\r\n\t\tvar ua = navigator.userAgent.toLocaleLowerCase();\r\n\t\t// 搜狗浏览器没 默认icon，要手动添加，而稍旧的版本不支持onclick属性\r\n\t\tif(ua.match(/metasr/) != null){\r\n\t\t\tchrome.contextMenus.create({\r\n\t\t\t\ttitle: \"添加到宝贝复制队列\",\r\n\t\t\t\tid: itemId,\r\n\t\t\t\ticon: {path: 'img/icon.png'},\r\n\t\t\t\t// 右键菜单只在下列网站可用\r\n\t\t\t\tdocumentUrlPatterns: documentUrlPatterns,\r\n\t\t\t\tonclick: function(){\r\n\t\t\t\t\tchrome.tabs.query({active: true, currentWindow: true}, function(currentTab){\r\n\t\t\t\t\t\t// 当前页面的url\r\n\t\t\t\t\t\t// 向当前页面的content-script 发送获取html内容的请求\r\n\t\t\t\t\t\tchrome.tabs.sendMessage(currentTab[0].id, {cmd: \"fetchHtmlAndDesc\"}, function(response) {\r\n\t\t\t\t\t\t\tresponse();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tchrome.contextMenus.onClicked.addListener(function(a, b) {\r\n\t\t\t\tif(a.menuItemId == itemId) {\r\n\t\t\t\t\tchrome.tabs.query({active: true, currentWindow: true}, function(currentTab){\r\n\t\t\t\t\t\t// 当前页面的url\r\n\t\t\t\t\t\t// 向当前页面的content-script 发送获取html内容的请求\r\n\t\t\t\t\t\tchrome.tabs.sendMessage(currentTab[0].id, {cmd: \"fetchHtmlAndDesc\"}, function(response) {\r\n\t\t\t\t\t\t\tresponse();\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\t\tchrome.contextMenus.create({\r\n\t\t\t\t\ttitle: \"添加到宝贝复制队列\",\r\n\t\t\t\t\tid: itemId,\r\n\t\t\t\t\t// 右键菜单只在下列网站可用\r\n\t\t\t\t\tdocumentUrlPatterns: documentUrlPatterns,\r\n\t\t\t\t\tonclick: function(){\r\n\t\t\t\t\t\tchrome.tabs.query({active: true, currentWindow: true}, function(currentTab){\r\n\t\t\t\t\t\t\t// 当前页面的url\r\n\t\t\t\t\t\t\t// 向当前页面的content-script 发送获取html内容的请求\r\n\t\t\t\t\t\t\tchrome.tabs.sendMessage(currentTab[0].id, {cmd: \"fetchHtmlAndDesc\"}, function(response) {\r\n\t\t\t\t\t\t\t\tresponse();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t// 电脑右下角通知\r\n\tnotify: function (params) {\r\n\t\tchrome.notifications.create(null, {\r\n\t\t\ttype: params.type || 'basic',\r\n\t\t\ticonUrl: params.iconUrl || 'img/icon.png',\r\n\t\t\ttitle: params.title || '这是标题',\r\n\t\t\tmessage: params.message || ''\r\n\t\t});\r\n\t},\r\n\tsetBadgeText: function (text) {\r\n\t\tchrome.browserAction.setBadgeText({text: text});\r\n\t},\r\n\tsetStorage: function(params) {\r\n\t\tchrome.storage.sync.set(params);\r\n\t}\r\n}\r\n\r\n\r\nfunction backgroundInit() {\r\n\t\r\n\tbgUtil.createMenuItem();\r\n\tbgUtil.setStorage({ver: bgUtil.ver});\r\n\t// 能够检测版本的url\r\n\t/* var verUrl = 'http://wdb.wonbao.com/goodsCopyVer.json';\r\n\t$.ajax({\r\n\t\ttype: \"GET\",\r\n\t\turl: verUrl,\r\n\t\tasync: false,\r\n\t\tdata: {},\r\n\t\tdataType: \"json\",\r\n\t\tsuccess: function(data){\r\n\t\t\tif(data.ver != bgUtil.ver) {\r\n\t\t\t\tbgUtil.setBadgeText('new');\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: function(data) {\r\n\t\t}\r\n\t});\r\n\t*/\r\n}\r\nbackgroundInit();\r\n//-------------------- badge演示 ------------------------//\r\nvar contentMap = {\r\n}\r\n\r\n\r\n\r\nvar dlData = [];\r\n// 监听来自content-script的消息\r\nchrome.runtime.onMessage.addListener(function(request, sender, sendResponse)\r\n{\t\r\n\t// 只作测试用\r\n\tif(request.cmd =='default') {\r\n\t\t// console.log('收到来自content-script的消息：');\r\n\t\t// console.log(request, sender, sendResponse);\r\n\t\tsendResponse('我是后台，我已收到你的消息：' + JSON.stringify(request));\r\n\t} /*else if(request.cmd == 'receiveContent') { // 不再使用了\r\n\t\tvar id = request.id;\r\n\t\tif (!id) {\r\n\t\t\tcontentMap[id] = '';\r\n\t\t}\r\n\t\tcontentMap[id] = ((contentMap[id] || '')+ (request.content || ''));\r\n\r\n\t\t$.ajax({\r\n\t\t\ttype: \"POST\",\r\n\t\t\turl: \"http://localhost:3000/receive\",\r\n\t\t\tdata: {content: request.content, id: id},\r\n\t\t\tdataType: \"json\",\r\n\t\t\tsuccess: function(data){\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t}\r\n\t\t});\r\n\t} */\r\n\telse if (request.cmd == 'notifyIframeHtmlUsefull') { // 告知当前iframe 页面是否有内容\r\n\t\tchrome.tabs.query({}, function(tabs){\r\n\t\t\ttabs.forEach(function(tab, index) {\r\n\t\t\t\tif(tab.url.indexOf('localhost') > -1 || tab.url.indexOf('wonbao') > -1 || tab.url.indexOf('file:')>-1 || tab.url.indexOf('192.168') > -1 || tab.url.indexOf('yangkeduo.com/goods') > -1 && tab.url.indexOf('space.bilibili.com') > -1) {\r\n\t\t\t\t\tchrome.tabs.sendMessage(\r\n\t\t\t\t\t\ttabs[index].id, \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\tcmd: \"notifyIframeUsefull\",\r\n\t\t\t\t\t\t\thref: request.href,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfunction(response) {\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t\tsendResponse();\r\n\t}\r\n\telse if(request.cmd == 'notifyIframeCopyResult') {\r\n\t\tchrome.tabs.query({}, function(tabs){\r\n\t\t\ttabs.forEach(function(tab, index) {\r\n\t\t\t\t// console.log('c================', request)\r\n\t\t\t\tif(tab.url.indexOf('localhost') > -1 || tab.url.indexOf('wonbao') > -1 || tab.url.indexOf('file:')>-1 || tab.url.indexOf('192.168') > -1 || tab.url.indexOf('yangkeduo.com/goods') > -1 || tab.url.indexOf('space.bilibili.com') > -1) {\r\n\t\t\t\t\tchrome.tabs.sendMessage(\r\n\t\t\t\t\t\ttabs[index].id, \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\tcmd: \"reveiverIframeHtml\",\r\n\t\t\t\t\t\t\tcontent: request.content,\r\n\t\t\t\t\t\t\thref: request.href,\r\n\t\t\t\t\t\t\thtml: request.html\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfunction(response) {\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t\tsendResponse();\r\n\t} else if (request.cmd == 'openTab') { // 打开新tab页面\r\n\t\tvar params = request.params;\r\n\t\tchrome.tabs.create({url: params.url});\r\n\t} else if (request.cmd == 'notify') {\r\n\t\tvar params = request.params;\r\n\t\tchrome.notifications.create(null, {\r\n\t\t\ttype: params.type || 'basic',\r\n\t\t\ticonUrl: params.iconUrl || 'img/icon.png',\r\n\t\t\ttitle: params.title || '这是标题',\r\n\t\t\tmessage: params.message || ''\r\n\t\t});\r\n\t\tsendResponse();\r\n\t} else if (request.cmd == 'fetchData') { // 跨域获取数据\r\n\t\t$.ajax({\r\n\t\t\ttype: \"GET\",\r\n\t\t\turl: request.url,\r\n\t\t\ttimeout: request.timeout,\r\n\t\t\tasync: false,\r\n\t\t\tdata: {},\r\n\t\t\tdataType: \"json\",\r\n\t\t\tsuccess: function(data){\r\n\t\t\t\tvar dist = {\r\n\t\t\t\t\turl: request.url,\r\n\t\t\t\t\tres: data.responseText,\r\n\t\t\t\t\tuuid: request.uuid\r\n\t\t\t\t}\r\n\t\t\t\tsendFetchDataToContentScript(dist, \"reveiveFetchData\");\r\n\t\t\t\t/* chrome.notifications.create(null, {\r\n\t\t\t\t\ttype: params.type || 'basic',\r\n\t\t\t\t\ticonUrl: params.iconUrl || 'img/icon.png',\r\n\t\t\t\t\ttitle: params.title || '这是标题' + 'success',\r\n\t\t\t\t\tmessage: params.message || ''\r\n\t\t\t\t}); */\r\n\r\n\t\t\t\t// sendResponse((dist));\r\n\t\t\t},\r\n\t\t\terror: function(data) {\r\n\t\t\t\tvar dist = {\r\n\t\t\t\t\turl: request.url,\r\n\t\t\t\t\tres: data.responseText,\r\n\t\t\t\t\tuuid: request.uuid\r\n\t\t\t\t}\r\n\t\t\t\tsendFetchDataToContentScript(dist, \"reveiveFetchData\");\r\n\t\t\t\t/* chrome.notifications.create(null, {\r\n\t\t\t\t\ttype: params.type || 'basic',\r\n\t\t\t\t\ticonUrl: params.iconUrl || 'img/icon.png',\r\n\t\t\t\t\ttitle: params.title || '这是标题' + 'error',\r\n\t\t\t\t\tmessage: params.message || ''\r\n\t\t\t\t}); */\r\n\t\t\t\t// sendResponse(JSON.stringify(dist));\r\n\t\t\t}\r\n\t\t});\r\n\t\tsendResponse();\r\n\t} else if (request.cmd == 'notifyReceiveTaskFetchHtmlAndDesc') { // 右键点击后获取的数据\r\n\t\tchrome.tabs.query({}, function(tabs){\r\n\t\t\ttabs.forEach(function(tab, index) {\r\n\t\t\t\tif(tab.url.indexOf('localhost') > -1 || tab.url.indexOf('wonbao') > -1 || tab.url.indexOf('file:') > -1 || tab.url.indexOf('192.168') > -1) {\r\n\t\t\t\t\tchrome.tabs.sendMessage(tabs[index].id, {\r\n\t\t\t\t\t\t\tcmd: \"receiveNewQueue\",\r\n\t\t\t\t\t\t\turl: request.url,\r\n\t\t\t\t\t\t\thtml: request.html,\r\n\t\t\t\t\t\t\tdesc: request.desc,\r\n\t\t\t\t\t\t\tmsg: request.msg,\r\n\t\t\t\t\t\t}, function(response) {\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t\tsendResponse();\r\n\t} else if (request.cmd == 'httpRequest') {\r\n\t\tvar xhr = new XMLHttpRequest();\r\n\t\txhr.open(\"GET\", request.url, true);\r\n\t\txhr.responseType = request.responseType || 'blob';//\"arraybuffer\";\r\n\t\txhr.onreadystatechange = function() {\r\n\t\t\tif (xhr.readyState == 4) {\r\n\t\t\t\tif (xhr.status == 200 || xhr.status == 304) {\r\n\t\t\t\t\tvar blob = xhr.response;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(blob) {\r\n\t\t\t\t\t\tvar file = new FileReader();\r\n\t\t\t\t\t\tfile.onload =function() {\r\n\t\t\t\t\t\t\t// callback(blob);\r\n\t\t\t\t\t\t\tvar dist = {\r\n\t\t\t\t\t\t\t\turl: request.url,\r\n\t\t\t\t\t\t\t\tres: file.result,\r\n\t\t\t\t\t\t\t\tuuid: request.uuid,\r\n\t\t\t\t\t\t\t\tsuccess: true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsendFetchDataToContentScript(dist, 'receiveHttpRequest');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfile.readAsDataURL(blob);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar dist = {\r\n\t\t\t\t\t\turl: request.url,\r\n\t\t\t\t\t\tres: '',\r\n\t\t\t\t\t\tuuid: request.uuid,\r\n\t\t\t\t\t\tsuccess: false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsendFetchDataToContentScript(dist, 'receiveHttpRequest');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\txhr.send(null);\r\n\t\tsendResponse();\r\n\t} else if (request.cmd == 'sendDownload') { // 下载文件\r\n\t\t\r\n\t\tconsole.log(request.fileName);\r\n\r\n\t\ttry{\r\n\t\t\tchrome.downloads.download(\r\n\t\t\t\t{\r\n\t\t\t\t  url: request.url,\r\n\t\t\t\t  filename: request.fileName,\r\n\t\t\t\t  conflictAction: 'overwrite',\r\n\t\t\t\t  saveAs: false,\r\n\t\t\t\t},\r\n\t\t\t\tfunction (id, e) {\r\n\t\t\t\t\tconsole.log(1, id);\r\n\t\t\t\t\tconsole.log(2, e);\r\n\t\t\t\t  // id 是 Chrome 新建立的下载任务的 id\r\n\t\t\t\t  dlData[id] = {\r\n\t\t\t\t\turl: request.url,\r\n\t\t\t\t\tid: request.id,\r\n\t\t\t\t\tuuid: request.uuid,\r\n\t\t\t\t\tres: 'success'\r\n\t\t\t\t  }\r\n\t\t\t\t  /* console.log('downloadComplete');\r\n\t\t\t\t  sendFetchDataToContentScript(dlData[id], 'downloadComplete'); */\r\n\t\t\t\t},\r\n\t\t\t)\r\n\r\n\t\t} catch(e){\r\n\t\t\tconsole.log();\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\nchrome.downloads.onChanged.addListener(function(detail) {\r\n\tconsole.log(detail);\r\n\tconst data = dlData[detail.id];\r\n\tif (data) {\r\n\t\tlet msg = ''\r\n\t\tlet err = ''\r\n\t\t// 判断当前文件名是否正常。下载时必定会有一次 detail.filename.current 有值\r\n\t\t/* if (detail.filename && detail.filename.current) {\r\n\t\t\tconst changedName = detail.filename.current\r\n\t\t\tif (\r\n\t\t\tchangedName.endsWith('jfif') ||\r\n\t\t\tchangedName.match(UUIDRegexp) !== null\r\n\t\t\t) {\r\n\t\t\t// 文件名是 UUID\r\n\t\t\tdata.uuid = true\r\n\t\t\t}\r\n\t\t} */\r\n\t\tif (detail.state && detail.state.current === 'complete') {\r\n\t\t\tmsg = 'downloaded';\r\n\t\t\tsendFetchDataToContentScript(data, 'downloadComplete');\r\n\t\t\tdlData[detail.id] = '';\r\n\t\t}\r\n\t\tif (detail.error && detail.error.current) {\r\n\t\t\tmsg = 'download_err'\r\n\t\t\terr = detail.error.current\r\n\t\t\tdata.res = 'error';\r\n\t\t\tsendFetchDataToContentScript(data, 'downloadComplete');\r\n\t\t\tdlData[detail.id] = '';\r\n\t\t}\r\n\t\t// 返回信息\r\n\t\tif (msg) {\r\n\t\t\tchrome.tabs.sendMessage(data.tabId, { msg, data, err })\r\n\t\t\t// 清除这个任务的数据\r\n\t\t\tdlData[detail.id] = null\r\n\t\t}\r\n\t}\r\n\r\n})\r\n\r\n// 将跨域获取的数据传回到content-script, content-script 再传到宿主页面 \r\nfunction sendFetchDataToContentScript(data, cmd) {\r\n\tchrome.tabs.query({}, function(tabs){\r\n\t\ttabs.forEach(function(tab, index) {\r\n\t\t\tif( shouldSendToTab(tab.url) ) {\r\n\t\t\t\tchrome.tabs.sendMessage(\r\n\t\t\t\t\ttabs[index].id, \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tcmd: cmd,\r\n\t\t\t\t\t\turl: data.url,\r\n\t\t\t\t\t\tres: data.res,\r\n\t\t\t\t\t\tuuid: data.uuid\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction(response) {\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n\r\n$('#test_cors').click(function(e) {\r\n\t/* $.get('https://www.baidu.com', function(html){\r\n\t\tconsole.log( html);\r\n\t\talert('跨域调用成功！');\r\n\t}); */\r\n\t// var url = 'https://detail.1688.com/offer/577545270423.html';\r\n\tvar url = 'https://ai.taobao.com/search/index.htm?source_id=search&key=%E5%90%95';\r\n\t$.ajax({\r\n\t\ttype: \"GET\",\r\n\t\turl: url,\r\n\t\ttimeout: 10000000,\r\n\t\tasync: false,\r\n\t\tdata: {},\r\n\t\tdataType: \"json\",\r\n\t\tsuccess: function(data){\r\n\t\t\tconsole.log('success');\r\n\t\t\tconsole.log(data);\r\n\t\t},\r\n\t\terror: function(data) {\r\n\t\t\tconsole.log('error');\r\n\t\t\tconsole.log(data);\r\n\t\t}\r\n\t});\r\n});\r\n\r\n$('#get_popup_title').click(function (e) {\r\n\tvar views = chrome.extension.getViews({type:'popup'});\r\n\tif(views.length > 0) {\r\n\t\talert(views[0].document.title);\r\n\t} else {\r\n\t\talert('popup未打开！');\r\n\t}\r\n});\r\n\r\n// 获取当前选项卡ID\r\nfunction getCurrentTabId(callback)\r\n{\r\n\tchrome.tabs.query({active: true, currentWindow: true}, function(tabs)\r\n\t{\r\n\t\tif(callback) callback(tabs.length ? tabs[0].id: null);\r\n\t});\r\n}\r\n\r\n// 当前标签打开某个链接\r\nfunction openUrlCurrentTab(url)\r\n{\r\n\tgetCurrentTabId(function(tabId) {\r\n\t\tchrome.tabs.update(tabId, {url: url});\r\n\t})\r\n}\r\n\r\n// 新标签打开某个链接\r\nfunction openUrlNewTab(url)\r\n{\r\n\tchrome.tabs.create({url: url});\r\n}\r\n\r\n// 预留一个方法给popup调用\r\nfunction testBackground() {\r\n\talert('你好，我是background！');\r\n}\r\n\r\n/* \r\n// 是否显示图片\r\nvar showImage;\r\nchrome.storage.sync.get({showImage: true}, function(items) {\r\n\tshowImage = items.showImage;\r\n});\r\n\r\n// web请求监听，最后一个参数表示阻塞式，需单独声明权限：webRequestBlocking\r\nchrome.webRequest.onBeforeRequest.addListener(function (details) {\r\n\t// cancel 表示取消本次请求\r\n\tif(!showImage && details.type == 'image') return {cancel: true};\r\n\t// 简单的音视频检测\r\n\t// 大部分网站视频的type并不是media，且视频做了防下载处理，所以这里仅仅是为了演示效果，无实际意义\r\n\tif(details.type == 'media') {\r\n\t\tchrome.notifications.create(null, {\r\n\t\t\ttype: 'basic',\r\n\t\t\ticonUrl: 'img/icon.png',\r\n\t\t\ttitle: '检测到音视频',\r\n\t\t\tmessage: '音视频地址：' + details.url,\r\n\t\t});\r\n\t}\r\n}, {urls: [\"<all_urls>\"]}, [\"blocking\"]); */\n\n\n// WEBPACK FOOTER //\n// ./src/background.js"],"sourceRoot":""}